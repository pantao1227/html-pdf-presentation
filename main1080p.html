<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <link rel="stylesheet" href="./css/style1080p.css" />
        <link rel="stylesheet" href="./css/github-markdown-light.css" />
        <!-- 代码高亮 -->
        <link rel="stylesheet" href="js/highlightjs/styles/github-gist.css">
        <script src="js/highlightjs/highlight.pack.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>

        <!-- 显示行号 -->
        <script src="js/line_number/highlightjs-line-numbers.min.js"></script>
        <script>hljs.initLineNumbersOnLoad();</script>

        <!-- Markdown 渲染 -->
        <script src="./js/markdown-it.min.js"></script>

        <!-- 图表工具 -->
        <script src="./js/echarts.js"></script>
    </head>
    <style>
        footer {
            border-top: 1px solid;
            display: grid;
            grid-template-columns: auto 1fr auto;
        }
        footer div {
            text-align: center;
        }
        .contents ol {
            padding: 0px 20px;
        }
        .contents li {
            list-style: cjk-ideographic;
        }
        .contents li > ol > li {
            list-style: decimal;
        }
        .contents-title {
            font-size: 5vw;
            padding: 0 20px;
        }
    </style>
    <body>
        <!-- h1 h2 由 JavaScript 控制 -->
        <section style="justify-content: center; align-items: center;">
            <div style="font-size: 10vh;">总标题</div>
        </section>
        <section style="justify-content: center; align-items: center;">
            <div id='contents' class="contents">
                <div class="contents-title">目录</div>
            </div>
        </section>
        <article title="第一章">
            <!-- article 内部的 section 可能会被用来生成序号，如果不想被计入，使用 .section -->
            <div class="section" style="align-items: center; justify-items: center;">
                <flex-h style="align-items: center; justify-items: center;">
                    <h1 style="font-size: 6vw;"></h1><span style="font-size: 10vw; margin-left: 6vw;">节标题</span>
                </flex-h>
            </div>
            <section title="普通文本">
                <div class="main">
                    <h2></h2>
                    <p>ABCDEFG</p>
                    <p>中文文本</p>
                </div>
                <footer></footer>
            </section>
            <section title="左图右文本">
                <div class="main">
                    <h2></h2>
                    <div class="grid-layout" style="grid-template-columns: 1fr 1fr;">
                        <img src="https://bkimg.cdn.bcebos.com/pic/314e251f95cad1c8281be0b87e3e6709c83d5188?x-bce-process=image/resize,m_lfit,w_440,limit_1/format,f_auto" />
                        <p>
                            与非门是与门和非门的结合，先进行与运算，再进行非运算。与非运算输入要求有两个，如果输入都用0和1表示的话，那么与运算的结果就是这两个数的乘积。如1和1（两端都有信号），则输出为0；1和0，则输出为1；0和0，则输出为1。与非门的结果就是对两个输入信号先进行与运算，再对此与运算结果进行非运算的结果。简单说，与非与非，就是先与后非。
                        </p>
                    </div>
                </div>
                <footer></footer>
            </section>
            <section title="图文 | 图文">
                <div class="main">
                    <h2></h2>
                    <!-- data-img-h 的值通过 JavaScript 传递到内部的 img 标签 style 的 height -->
                    <div class="grid-layout" style="grid-template-columns: 1fr 1fr; grid-template-rows: 1fr auto;" data-img-h="30vw">
                        <img src="https://bkimg.cdn.bcebos.com/pic/b64543a98226cffce0cf8b31b8014a90f703ea48?x-bce-process=image/resize,m_lfit,w_440,limit_1/format,f_auto" />
                        <p>
                            开关逻辑
                        </p>
                        <img src="https://bkimg.cdn.bcebos.com/pic/279759ee3d6d55fb80e941a56c224f4a20a4dd01?x-bce-process=image/resize,m_lfit,w_440,limit_1/format,f_auto" />
                        <p>
                            CMOS逻辑
                        </p>
                    </div>
                </div>
                <footer></footer>
            </section>
            <section title="图文 | 图文 | 图文">
                <div class="main">
                    <h2></h2>
                    <div class="grid-layout" style="grid-template-columns: 1fr 1fr1 f1r; grid-template-rows: 1fr auto;" data-img-h="20vw">
                        <img src="https://bkimg.cdn.bcebos.com/pic/314e251f95cad1c8281be0b87e3e6709c83d5188?x-bce-process=image/resize,m_lfit,w_440,limit_1/format,f_auto" />
                        <p>
                            ANSI/IEEE Std 91-1984
                        </p>
                        <img src="https://bkimg.cdn.bcebos.com/pic/80cb39dbb6fd52666123238baa18972bd4073620?x-bce-process=image/resize,m_lfit,w_440,limit_1/format,f_auto" />
                        <p>
                            IEC 60617-12
                        </p>
                        <img src="https://bkimg.cdn.bcebos.com/pic/d4628535e5dde711cec15c69a6efce1b9d166119?x-bce-process=image/resize,m_lfit,w_440,limit_1/format,f_auto" />
                        <p>
                            DIN 40700
                        </p>
                    </div>
                </div>
                <footer></footer>
            </section>
            <section title="代码 | 文字">
                <div class="main">
                    <h2></h2>
                    <div class="grid-layout" style="grid-template-columns: 1fr 1fr;">
                        <pre>
<code class="c">#include &lt;stdio.h&gt;
int mian()
{
    printf("Hello World!");

    return 0;
}
</code>
                        </pre>
                        <p>
                            这段 C 代码打印 Hello World!
                        </p>
                    </div>
                </div>
                <footer></footer>
            </section>
        </article>
        
        <article title="第二章">
            <div class="section" style="align-items: center; justify-items: center;">
                <flex-h style="align-items: center; justify-items: center;">
                    <h1 style="font-size: 6vw;"></h1><span style="font-size: 10vw; margin-left: 6vw;">节标题</span>
                </flex-h>
            </div>
            <section title="使用 Markdown | 使用 ECharts">
                <div class="main">
                    <h2></h2>
                    <div class="grid-layout" style="grid-template-columns: 1fr 1fr;">
                        <div class="markdown-container" style="font-size: 2vw;">

表格标题

|序号|选项一|选项二|
|----|----|----|
|1|abc|def|
|2|ghi|jkl|
|3|mno|pqr|
                        </div>
                        <div id="chart_1" style="height: 400px; width: 600px;"></div>
                        <script>
                             // 基于准备好的dom，初始化echarts实例
                            var myChart = echarts.init(document.getElementById('chart_1'));

                            // 指定图表的配置项和数据
                            var option = {
                                animation: false,
                                title: {
                                    text: 'Referer of a Website',
                                    subtext: 'Fake Data',
                                    left: 'center'
                                },
                                tooltip: {
                                    trigger: 'item'
                                },
                                series: [
                                    {
                                        name: 'Access From',
                                        type: 'pie',
                                        radius: '50%',
                                        data: [
                                            { value: 1048, name: 'Search Engine' },
                                            { value: 735, name: 'Direct' },
                                            { value: 580, name: 'Email' },
                                            { value: 484, name: 'Union Ads' },
                                            { value: 300, name: 'Video Ads' }
                                        ],
                                        emphasis: {
                                            itemStyle: {
                                            shadowBlur: 10,
                                            shadowOffsetX: 0,
                                            shadowColor: 'rgba(0, 0, 0, 0.5)'
                                            }
                                        },
                                        label: {
                                            normal: {
                                                show: true,
                                                formatter: '{b}: {c}({d}%)'
                                            }
                                        }
                                    }
                                ]
                            };

                            // 使用刚指定的配置项和数据显示图表。
                            myChart.setOption(option);
                        </script>
                    </div>
                </div>
                <footer></footer>
            </section>
            <section title="第二节">
                <div class="main">
                    ABCDEFG
                </div>
                <footer></footer>
            </section>
        </article>

        <!-- 脚本 -->
        <script>
            function get_section(elem) {
                var rr = elem;
                var max_loop = 20;
                while(rr.tagName != 'SECTION') {
                    max_loop--;
                    if(max_loop < 0) {
                        return null;
                    }
                    rr = rr.parentElement;
                }
                return rr;
            }

            function get_section_title(elem) {
                var rr = get_section(elem);
                if (rr != null) {
                    return rr.getAttribute('title');
                } else {
                    return '';
                }
            }

            function get_article(elem) {
                var rr = elem;
                var max_loop = 20;
                while(rr.tagName != 'ARTICLE') {
                    max_loop--;
                    if(max_loop < 0) {
                        return null;
                    }
                    rr = rr.parentElement;
                }
                return rr;
            }

            function get_article_title(elem) {
                var rr = get_article(elem);
                if (rr != null) {
                    return rr.getAttribute('title');
                } else {
                    return '';
                }
            }

            function gen_contents() {
                function gen_li(txt) {
                    var rr = document.createElement('LI');
                    rr.innerHTML = txt;
                    return rr;
                }
                var ct = document.createElement('OL');
                document.querySelectorAll('article').forEach(function(ats){
                    var curr_li = document.createElement('LI');
                    ct.appendChild(curr_li);
                    var curr_ol = document.createElement('OL');
                    curr_li.appendChild(curr_ol);
                    curr_ol.appendChild(document.createTextNode(ats.getAttribute('title')));
                    ats.querySelectorAll('section').forEach(function(sts){
                        curr_ol.appendChild(gen_li(sts.getAttribute('title')));
                    });
                });
                document.getElementById('contents').appendChild(ct);
                return ct;
            }

            // 填充页脚
            ft_list = document.querySelectorAll('footer');
            for (let i = 0; i < ft_list.length; i++) {
                ft_list[i].appendChild(document.createElement('DIV'));
                ft_list[i].appendChild(document.createElement('DIV'));
                ft_list[i].appendChild(document.createElement('DIV'));
                ft_list[i].querySelectorAll('DIV')[0].innerHTML = get_article_title(ft_list[i]) + ' - ' + get_section_title(ft_list[i]);
                ft_list[i].querySelectorAll('DIV')[2].innerHTML = '第 ' + Number(i + 1) + ' 页，共 ' + ft_list.length + ' 页';
            };
            // 填充 h1 标题
            h1_list = document.querySelectorAll('h1');
            for (let i = 0; i < h1_list.length; i++) {
                h1_list[i].innerHTML = get_article_title(h1_list[i]);
            }

            // 填充 h2 标题
            h2_list = document.querySelectorAll('h2');
            for (let i = 0; i < h2_list.length; i++) {
                h2_list[i].innerHTML = get_section(h2_list[i]).getAttribute('title');
            }

            // 局部统一图片高度
            var all_div = document.querySelectorAll('DIV');
            var with_data_img_h = [];
            for (let i = 0; i < all_div.length; i++) {
                var txth = all_div[i].getAttribute('data-img-h');
                if (txth != null & txth != '') {
                    with_data_img_h.push(all_div[i]);
                }
            }
            for (let i = 0; i < with_data_img_h.length; i++) {
                var img_list = with_data_img_h[i].querySelectorAll('img');
                var height_txt = with_data_img_h[i].getAttribute('data-img-h');
                for (let j = 0; j < img_list.length; j++) {
                    img_list[j].style.height = height_txt;
                }
            }

            // 生成目录
            gen_contents();

            // 处理 Markdown
            var md = window.markdownit();
            md_list = document.querySelectorAll('.markdown-container');
            md_list.forEach(function(item){
                var md_src_txt = item.innerHTML;
                item.innerHTML = md.render(md_src_txt);
                item.classList.add('markdown-body');
            });
        </script>
    </body>
</html>